import{I as M,S as J,P as W,T as X,C as O,h as $}from"./index-4d0de1f8.js";import{I as z}from"./index-efd6cdc7.js";import{_ as L,r as u,o,c as n,N as ee,n as y,d as c,f as a,E as p,F as S,h as k,O as I,C as F,g as h,e as l,u as j,a as te,l as B,P as N,q as R,w as oe,A as ne,Q as q,K as ae,L as se}from"./main-23d9f12c.js";import{T as ie,c as le,d as H,a as E,u as re,b as P}from"./object-61f57073.js";import{D as ce,r as de}from"./index-18f43d50.js";import"./vue-cleave.min-c8018730.js";const ue={components:{Icon:z},name:"Button",props:{text:{type:String,default:""},isDisabled:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},btnClass:{type:String,default:"bg-primary-500 text-white"},icon:{type:String,default:""},iconPosition:{type:String,default:"left"},iconClass:{type:String,default:"text-[20px]"},loadingClass:{type:String,default:""},link:{type:String,default:""},div:{type:Boolean,default:!1}}},me=["disabled"],_e={key:0,class:"flex items-center"},ge={key:1},he=l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),fe=l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),ye=[he,fe],be={key:2},pe={key:0,class:"flex items-center"},ve={key:1},we=l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),ke=l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),xe=[we,ke],Ce={key:2},Se={key:0,class:"flex items-center"},Pe={key:1},Le=l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Te=l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Ve=[Le,Te],Ie={key:2};function Be(s,i,e,t,f,b){const r=u("Icon"),g=u("router-link");return o(),n(S,null,[!e.link&&!e.div?(o(),n("button",ee({key:0,disabled:e.isDisabled,class:["btn inline-flex justify-center",`
    ${e.isLoading?" pointer-events-none":""}
    ${e.isDisabled?" opacity-40 cursor-not-allowed":""}
    ${e.btnClass}
    `]},s.$attrs),[!e.isLoading&&!s.$slots.default?(o(),n("span",_e,[e.icon?(o(),n("span",{key:0,class:y(`
          ${e.iconPosition==="right"?"order-1 ltr:ml-2 rtl:mr-2":" "}
          ${e.text&&e.iconPosition==="left"?"ltr:mr-2 rtl:ml-2":""}
          
          ${e.iconClass}
          
          `)},[c(r,{icon:e.icon},null,8,["icon"])],2)):a("",!0),e.text?(o(),n("span",ge,p(e.text),1)):a("",!0)])):a("",!0),e.isLoading?(o(),n(S,{key:1},[(o(),n("svg",{class:y(["animate-spin ltr:-ml-1 ltr:mr-3 rtl:-mr-1 rtl:ml-3 h-5 w-5",e.loadingClass]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ye,2)),k(" Loading ... ")],64)):a("",!0),s.$slots.default&&!e.isLoading?(o(),n("div",be,[I(s.$slots,"default")])):a("",!0)],16,me)):a("",!0),e.link&&!e.div?(o(),F(g,{key:1,to:e.link,class:y(["btn inline-flex justify-center",`
    ${e.isLoading?" pointer-events-none":""}
    ${e.isDisabled?" opacity-40 cursor-not-allowed":""}
    ${e.btnClass}
    `])},{default:h(()=>[!e.isLoading&&!s.$slots.default?(o(),n("span",pe,[e.icon?(o(),n("span",{key:0,class:y(`
          ${e.iconPosition==="right"?"order-1 ltr:ml-2 rtl:mr-2":" "}
          ${e.text&&e.iconPosition==="left"?"ltr:mr-2 rtl:ml-2":""}
          
          ${e.iconClass}
          
          `)},[c(r,{icon:e.icon},null,8,["icon"])],2)):a("",!0),e.text?(o(),n("span",ve,p(e.text),1)):a("",!0)])):a("",!0),e.isLoading?(o(),n(S,{key:1},[(o(),n("svg",{class:y(["animate-spin -ml-1 mr-3 h-5 w-5",e.loadingClass]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},xe,2)),k(" Loading ... ")],64)):a("",!0),s.$slots.default&&!e.isLoading?(o(),n("div",Ce,[I(s.$slots,"default")])):a("",!0)]),_:3},8,["to","class"])):a("",!0),e.div&&!e.link?(o(),n("div",{key:2,class:y(["btn inline-flex justify-center",`
    ${e.isLoading?" pointer-events-none":""}
    ${e.isDisabled?" opacity-40 cursor-not-allowed":""}
    ${e.btnClass}
    `])},[!e.isLoading&&!s.$slots.default?(o(),n("span",Se,[e.icon?(o(),n("span",{key:0,class:y(`
          ${e.iconPosition==="right"?"order-1 ltr:ml-2 rtl:mr-2":" "}
          ${e.text&&e.iconPosition==="left"?"ltr:mr-2 rtl:ml-2":""}
          
          ${e.iconClass}
          
          `)},[c(r,{icon:e.icon},null,8,["icon"])],2)):a("",!0),e.text?(o(),n("span",Pe,p(e.text),1)):a("",!0)])):a("",!0),e.isLoading?(o(),n(S,{key:1},[(o(),n("svg",{class:y(["animate-spin -ml-1 mr-3 h-5 w-5",e.loadingClass]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ve,2)),k(" Loading ... ")],64)):a("",!0),s.$slots.default&&!e.isLoading?(o(),n("div",Ie,[I(s.$slots,"default")])):a("",!0)],2)):a("",!0)],64)}const De=L(ue,[["render",Be]]),He={components:{Textinput:ie,Button:De,InputGroup:M,Select:J},setup(){const s=j(),i=te(),e=B([{value:"desktop",label:"Desktop"},{value:"mobile",label:"Mobile"}]),t=B([]),f=le({repetitions:H().required().min(1).max(100),keyword:E().required(),location_code:H().required(),device:E().required()}),{errors:b,values:r,handleSubmit:g,isSubmitting:m}=re({validationSchema:f}),{value:v,errorMessage:_}=P("repetitions"),{value:T,errorMessage:d}=P("keyword"),{value:V,errorMessage:U}=P("location_code"),{value:G,errorMessage:K}=P("device");let x=!1;const Y=g(async()=>{try{if(x)return null;x=!0;const C=(await axios.post(N.trackRank(),{keyword:r.keyword,device:r.device,location_code:Number(r.location_code),repetitions:Number(r.repetitions)})).data.data.search;i.push({name:"search-details",params:{id:C.id}}),x=!1}catch(w){s.error("Error tracking ranks: "+w.message,{timeout:2e3}),x=!1}}),Q=async()=>{var w;try{const Z=(w=(await axios.get("location")).data.data.locations)==null?void 0:w.map(D=>({label:D.label,value:D.code}));t.value=Z}catch(C){s.error("Error fetching locations: "+C.message,{timeout:2e3})}};return R(()=>{Q()}),{isSubmitting:m,repetitions:v,repetitionsError:_,keyword:T,keywordError:d,location_code:V,location_codeError:U,device:G,deviceError:K,deviceOptions:e,locationOptions:t,onSubmit:Y}}},Ee={class:"lg:col-span-1 col-span-7"},Me={class:"lg:col-span-1 col-span-7"},Oe={class:"lg:col-span-1 col-span-7"},ze={class:"lg:col-span-4 col-span-7"};function Fe(s,i,e,t,f,b){const r=u("Select"),g=u("Textinput"),m=u("Button"),v=u("InputGroup");return o(),n("form",{onSubmit:i[4]||(i[4]=oe((..._)=>t.onSubmit&&t.onSubmit(..._),["prevent"])),class:"grid lg:grid-cols-7 grid-cols-1 gap-5 items-start"},[l("div",Ee,[t.locationOptions.length?(o(),F(r,{key:0,label:"Location",modelValue:t.location_code,"onUpdate:modelValue":i[0]||(i[0]=_=>t.location_code=_),name:"location_code",placeholder:"Select Location",options:t.locationOptions,error:t.location_codeError},null,8,["modelValue","options","error"])):a("",!0)]),l("div",Me,[c(r,{label:"Device",modelValue:t.device,"onUpdate:modelValue":i[1]||(i[1]=_=>t.device=_),name:"device",placeholder:"Select Device",options:t.deviceOptions,error:t.deviceError},null,8,["modelValue","options","error"])]),l("div",Oe,[c(g,{label:"Repetitions",type:"number",placeholder:"1",name:"repetitions",modelValue:t.repetitions,"onUpdate:modelValue":i[2]||(i[2]=_=>t.repetitions=_),error:t.repetitionsError},null,8,["modelValue","error"])]),l("div",ze,[c(v,{label:"Keyword",modelValue:t.keyword,"onUpdate:modelValue":i[3]||(i[3]=_=>t.keyword=_),type:"text",placeholder:"Enter Keywords",error:t.keywordError},{append:h(()=>[c(m,{type:"submit",icon:"heroicons-outline:search",text:"Track",btnClass:"btn-outline-primary",isLoading:t.isSubmitting,disabled:t.isSubmitting},null,8,["isLoading","disabled"])]),_:1},8,["modelValue","error"])])],32)}const je=L(He,[["render",Fe]]);const Ne={components:{Pagination:W,Tooltip:X,InputGroup:M,Dropdown:ce,Icon:z,Card:O,MenuItem:de},data(){return{pageRange:5,searchTerm:"",actions:[{name:"view",icon:"heroicons-outline:eye"},{name:"edit",icon:"heroicons:pencil-square"},{name:"delete",icon:"heroicons-outline:trash"}],options:[{value:"1",label:"1"},{value:"3",label:"3"},{value:"5",label:"5"}],columns:[{label:"Id",field:"id"},{label:"Keyword",field:"keyword"},{label:"User",field:"user"},{label:"Date",field:"date"},{label:"Device",field:"device"},{label:"Location",field:"location"},{label:"Repetitions",field:"repetitions"},{label:"Action",field:"action"}]}},setup(){const s=j(),i=B([]),e=ne({}),t=async(f=1)=>{try{const b=await axios.get(N.searchHistory(f)),{data:r,...g}=b.data.data.searches;i.value=r.map(m=>({...m,user:{name:m.user.name,image:m.user.image},location:m.location.label,date:$(m.created_at).format("YYYY-MM-DD hh:mm Z")})),Object.assign(e,g),q.done()}catch{s.error("Error fetching Search records",{timeout:2e3})}};return R(()=>{t()}),{fetchSearchHistory:t,searchHistory:i,searchHistoryPagination:e}}},A=s=>(ae("data-v-b9b1a1f2"),s=s(),se(),s),Re=A(()=>l("div",{class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},[l("h5",null,"History")],-1)),qe={key:0,class:"flex items-center"},Ae={class:"w-7 h-7 rounded-full mr-3 flex-none"},Ue=["src","alt"],Ge={class:"text-sm text-slate-600 capitalize"},Ke={key:1,class:"text-blue-500"},Ye={key:2,class:"text-slate-500"},Qe={key:3},Ze={class:"flex space-x-3 justify-center"},Je={class:"action-btn"},We=A(()=>l("span",null,null,-1)),Xe={class:"py-4 px-3"};function $e(s,i,e,t,f,b){const r=u("router-link"),g=u("Icon"),m=u("Tooltip"),v=u("Pagination"),_=u("vue-good-table"),T=u("Card");return o(),n("div",null,[c(T,{noborder:""},{default:h(()=>[Re,c(_,{columns:f.columns,styleClass:" vgt-table bordered centered",rows:t.searchHistory,"pagination-options":{enabled:!0,perPage:t.searchHistoryPagination.perpage},"search-options":{enabled:!1,externalQuery:f.searchTerm},"select-options":{enabled:!1,selectOnCheckboxOnly:!0,selectioninfoClass:"custom-class",selectionText:"rows selected",clearSelectionText:"clear",disableSelectinfo:!0,selectAllByGroup:!0}},{"table-row":h(d=>[d.column.field=="user"?(o(),n("span",qe,[l("span",Ae,[l("img",{src:d.row.user.image,alt:d.row.user.name,class:"object-cover w-full h-full rounded-full"},null,8,Ue)]),l("span",Ge,p(d.row.user.name),1)])):a("",!0),d.column.field=="keyword"?(o(),n("span",Ke,[c(r,{to:{name:"search-details",params:{id:d.row.id}}},{default:h(()=>[k(p(d.row.keyword),1)]),_:2},1032,["to"])])):a("",!0),d.column.field=="date"?(o(),n("span",Ye,p(d.row.date),1)):a("",!0),d.column.field=="action"?(o(),n("span",Qe,[l("div",Ze,[c(m,{placement:"top",arrow:"",theme:"dark"},{button:h(()=>[c(r,{to:{name:"search-details",params:{id:d.row.id}}},{default:h(()=>[l("div",Je,[c(g,{icon:"heroicons:eye"})])]),_:2},1032,["to"])]),default:h(()=>[We]),_:2},1024)])])):a("",!0)]),"pagination-bottom":h(d=>[l("div",Xe,[c(v,{total:t.searchHistoryPagination.total,current:t.searchHistoryPagination.current_page,"per-page":t.searchHistoryPagination.perpage,pageRange:t.searchHistoryPagination.last_paage,onPageChanged:i[0]||(i[0]=V=>t.searchHistoryPagination.current_page=V),pageChanged:d.pageChanged,perPageChanged:d.perPageChanged,enableSearch:"",options:f.options},{default:h(()=>[k(" > ")]),_:2},1032,["total","current","per-page","pageRange","pageChanged","perPageChanged","options"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1})])}const et=L(Ne,[["render",$e],["__scopeId","data-v-b9b1a1f2"]]);const tt={components:{Card:O,SearchTable:et,SearchForm:je},setup(){q.start()}},ot={class:"space-y-5"};function nt(s,i,e,t,f,b){const r=u("SearchForm"),g=u("Card"),m=u("SearchTable");return o(),n("div",ot,[l("div",null,[c(g,null,{default:h(()=>[c(r)]),_:1})]),c(m)])}const dt=L(tt,[["render",nt]]);export{dt as default};
